import numpy as np
import random
from langchain_community.embeddings import GPT4AllEmbeddings
from .umap import umap

def gmm(documents, n_clusters):
    # Dimensionality of points
    dim = documents.shape[1]
    size = documents.shape[0]

    # All pi's should add up to 1
    random_numbers = np.random.rand(n_clusters)
    pi = np.array(random_numbers / np.sum(random_numbers))

    # Initialize means by randomly choosing data points
    mean = np.array(random.sample(documents.tolist(), k=n_clusters))  
    responsibilities = np.zeros([n_clusters, size])

    # Initialize covariance matrices by assigning each one as an identity matrix of size (classes, dim, dim)
    cov  = np.tile(np.identity(dim), (n_clusters, 1, 1))
    cov += np.eye(dim) * 1e-6

    # Compute responsibilities
    def expectation(pi, mean, cov):
        def get_gaussian_sum(gaussian):
            gaussian_sums = np.zeros([size]) # Sum of gaussian for (all)point j across all i classes
            for i in range(size):
                for j in range(n_clusters):
                    gaussian_sums[i] += gaussian[j, i]

            return gaussian_sums
        
        dif = np.zeros([n_clusters, size, dim])
        mahalanobis = np.zeros([n_clusters, size])
        exp = np.zeros_like(mahalanobis)
        N = np.zeros_like(exp)
        gaussian = np.zeros_like(N)

        for i in range(n_clusters):
            determinant = np.linalg.det(cov[i])
            normalization_constant = 1 / (((2 * np.pi) ** (dim/2)) * np.sqrt(determinant))

            for j in range(size): # each data point
                dif[i, j] = np.array(documents[j] - mean[i])
                mahalanobis[i, j] = np.dot(np.dot(dif[i, j].T, np.linalg.inv(cov[i])), dif[i, j])

                exp[i, j] = np.exp(-0.5 * mahalanobis[i, j])

                N[i, j] = normalization_constant * exp[i, j]
                gaussian[i, j] = pi[i] * N[i, j]

        gaussian_sums = get_gaussian_sum(gaussian)

        for i in range(n_clusters):
            for j in range(size):
                responsibilities[i, j] = gaussian[i, j] / gaussian_sums[j]
        return responsibilities, N, dif

    # Compute pi, mean, and cov using responsibilities obtained
    def maximization(responsibilities, dif):
        new_pi = np.zeros_like(pi, dtype=float)
        new_mean = np.zeros_like(mean, dtype=float)
        new_cov = np.zeros_like(cov, dtype=float)

        for i in range(n_clusters):
            resp_sum = np.sum(responsibilities[i])
            new_pi[i] = resp_sum / size
            new_mean[i] = np.sum([responsibilities[i, j] * documents[j] for j in range(size)], axis=0) / resp_sum
            new_cov[i] = np.sum([responsibilities[i, j] * np.outer(dif[i, j], dif[i, j].T) for j in range(size)], axis=0) / resp_sum
            new_cov[i] += np.eye(dim) * 1e-6  # Regularize covariance

        return new_pi, new_mean, new_cov

    def get_log_likelihood(N, pi):
        log_likelihood = 0
        for i in range(size):
            likelihood = 0
            for j in range(n_clusters):
                likelihood += pi[j] * N[j, i]
            log_likelihood += np.log(likelihood)

        return log_likelihood

    def EMAlgorithm(responsibilities, pi, mean, cov, max_itt=50000, min_gain=1e-6):
        old_log_likelihood = None
        for _ in range(max_itt):
            # E-step
            responsibilities, N, dif = expectation(pi, mean, cov)

            # Compute log-likelihood after E-step
            log_likelihood = get_log_likelihood(N, pi)

            # Check for convergence
            if old_log_likelihood is not None:
                gain = log_likelihood - old_log_likelihood
                if gain < min_gain:
                    break

            # M-step
            pi, mean, cov = maximization(responsibilities, dif)
            old_log_likelihood = log_likelihood

        return log_likelihood, pi, mean, cov

    log_likelihood, pi, mean, cov = EMAlgorithm(responsibilities, pi, mean, cov)

    return log_likelihood, pi, mean, cov

x = ['processing (EMNLP) , pp. 1532 -1543. 2014.  \n[13] Nakov, Preslav, Alan Ritter, Sara Rosenthal, Fabrizio Sebastiani, and \nVeselin Stoyanov. "SemEval -2016 task 4: Sentiment analysis in \nTwitter." In  Proceedin gs of the 10th international workshop on \nsemantic evaluation (semeval -2016) , pp. 1 -18. 2016.  \n[14] Arora, Sanjeev, Yingyu Liang, and Tengyu Ma. "A simple but tough -\nto-beat baseline for sentence embeddings." (2016).  \n[15] Agarwal, Apoorv, Boyi Xie, Ilia Vovsha, Owen Ra mbow, and \nRebecca Passonneau. "Sentiment analysis of twitter data." \nIn Proceedings of the Workshop on Language in Social Media (LSM \n2011) , pp. 30 -38. 2011.  \n[16] Pak, Alexander, and Patrick Paroubek. "Twitter as a corpus for \nsentiment analysis and opinion mining ." In LREc , vol. 10, no. 2010, \npp. 1320 -1326. 2010.', 'sentimental analysis task by collecting only the \npositive and negative reviews for the sentimental \nanalysis task.  \n This paper deals with the data that has been taken from the \nTwitter , the tweets from the Twitter  and we have named the \ncollected data as “Amrita -CEN -SentiDB1 ”. In this dataset \nonly the positive and t he negative tweets are taken into \nconsideration. The task here is to train the model with the \ndataset that is present and the trained model should classify \nthe correct class to which the sentence belongs to when \ntested with the test data.  The rest of the s ections are \narranged as follows Related works in Section [II], \nBackground in Section [III], Dataset description in Section \n[IV], Methodology in Section [V], Statistical methods in \nSection [VI], Experimental analysis and results in Section \n[VII], Conclusion  in Section [VIII].  \nII. RELATED WORKS  \nThis section all about deals with the existing methods from \nthe classical  to the current methods that are being followed \nin the sentiment analysis which uses the data from the \nTwitter, with the term frequency inverse docum ent \nfrequency ( tfidf) and the global vectors (g lovec ) as the', '·Features ·Social media ·Machine learning\n·Supervised algorithm ·Naive Bayes classiﬁer\n1 Introduction\nOpinion plays an important role in deciding about everything in the life asmillions of people express their thoughts through personal blogs, social network-ing sites and many more. Opinions are private states, which are not directlyobservable by others but expressions of opinion can be reﬂected through actionsincluding written and spoken languages [1]. Sentiment analysis which is alsoknown as opinion mining is a task in Natural Language processing which dealswith the discernment and categorization of opinions in narrative [ 2]. Predom- inantly, these opinions are classiﬁed into positive, negative and neutral classesand is thus helpful in many ﬁelds including marketing, sociology, psychology etc.[3] Sentiment Analysis is popular for English languages and it is found rarely forIndian Languages [4].Twitter, a microblogging stage, permits its clients to post short messagesabout any subject what’s more, tail others to get their posts. Many individuals\nc/circlecopyrtSpringer International Publishing Switzerland 2015R. Prasath et al. (Eds.): MIKE 2015, LNAI 9468, pp. 703–710, 2015.DOI: 10.1007/978-3-319-26832-3', 'use Twitter as a platform to communicate with each other. The objective of thisexamination is to study client opinion communicated on Twitter and to add to asystem that permits observing it in the constant. Tweet planning among othersinclude spelling correction, equivalent word substitution, hyperlink cancellationand stop words are performed [5]. Notion is physically ordered the slant intothree classes: positive, neutral and negative, so as to make the preparation set forthe classiﬁer [6]. The classiﬁed tweets are utilized to make positive, neutral andnegative feeling lists. The sensational increment in the utilization of the internetas a method for correspondence has been joined by a sensational change in theway individuals express their opinion and perspective [7]. They can express theirsurveys online about items and administrations and also the perspectives aboutanything by means of social network (i.e. web journals, examination discussions).Sentiwordnet is one of the widely used lexicon resources for sentiment analysis,emotional analysis, opinion mining [8]. Sentiwordnet is an automatically createdlexicon with positive and negative scores [9,10].The contemporary work is done as slice of shared task in Sentiment Analysisin Indian Language (SAIL) 2015, constrain category. The task which containsthree classes (positive, negative, neutral) of twitter data in three languages -Hindi, Bengali and Tamil is to identify the sentiment of the given tweet in agiven', 'hand, Sentimentanalysis allows the user express more precise feelings about a product or service inthe market. This is because, unlike the star system, sentiment analysis feeds off thereviews written by users. A user is free to use the complete English vocabulary toexpress his/her feelings axed weight to every possible emoticon, indicating whetherthe opinion is positive, negative, or neutral.', 'the authors have performed classi- ﬁcation about 6799 tokens of Twitter data to identify sentiment score. Rafeek Remyain [14] discussed methods to detect polarity in sentiment analysis regression models.He considered product review dataset and the evaluation results obtained showed animproved classiﬁcation accuracy.', '2015, constrain category. The task which containsthree classes (positive, negative, neutral) of twitter data in three languages -Hindi, Bengali and Tamil is to identify the sentiment of the given tweet in agiven language. The main objective of the share task is to stimulate researchersto accomplish sentiment analysis in their endemic language. Section 2provides a view about the methodology used in the system; Sect. 3discusses about the short analysis of the dataset provided to the work; Sect.4discusses about variousexperiments and their results.', '[1] Mohammad, Saif M., and Felipe Bravo -Marquez. "Emotion \nintensities in tweets."  arXiv preprint arXiv:1708.03696  (2017).  \n[2] Kiritchenko, S., Zhu, X. and Mohammad, S.M., 2014. Sentiment \nanalysis of short informal texts.  Journal of Artificial In telligence \nResearch , 50, pp.723 -762. \n[3] Mohammad, Saif M., Parinaz Sobhani, and Svetlana Kiritchenko. \n"Stance and sentiment in tweets."  ACM Transactions on Internet \nTechnology (TOIT)  17, no. 3 (2017): 26.  \n[4] Mohammad, Saif, Felipe Bravo -Marquez, Mohammad Salameh , and \nSvetlana Kiritchenko. "Semeval -2018 task 1: Affect in tweets." \nIn Proceedings of The 12th International Workshop on Semantic \nEvaluation , pp. 1 -17. 2018.  \n[5] Binali, Haji H., Chen Wu, and Vidyasagar Potdar. "A new significant \narea: Emotion detection in e -learning using opinion mining \ntechniques." In  2009 3rd IEEE International Conference on Digital', '1. Fink, C.R., et al.: Coarse- and ﬁne-grained sentiment analysis of social media text.Johns Hopkins APL Tech. Dig. 30(1), 22–30 (2011)2. Balahur, A.: Sentiment analysis in social media texts. In: 4th Workshop on Com-putational Approaches (2013) 710 S. Se et al.3. Hutto, C.J., Gilbertl, E.: Vader: a parsimonious rule-based model for sentimentanalysis of social media text. In: Eighth International AAAI Conference on Weblogsand Social Media (2014)4. Arunselvan, S.J., Anand kumar, M., et al.: Sentiment analysis of tamil mooviereviews via feature frequency count. IJAER 10, 17934–17939 (2015)5. Jansen, B.J., et al.: Twitter power: tweets as electronic word of mouth. J. Am.Soc. Inf. Sci. Technol.60(11), 2169–2188 (2009)6. Hiroshi, K., et al.: Deeper sentiment analysis using machine translation technology.In: 20th International Conference on Computational Linguistics (2004)7. John, G.H., Langley, P.: Estimating continuous distributions in Bayesian classiﬁers.In: Eleventh Conference on', 'being studied and analyzed with the help of the \nmicroblogging  [16] [9]. The dataset which is used in the \ntask is of the Twitter  dataset and the corpus collection \nconsists of the various emoticons that corresponds to that of \nthe either happy or  sad. The SVM and the navie b ayes are \nused for the classification. The use r generated r eviews are \nan another task [10] [22] which has the lots of the sentiment \ndetails hidden in them so there are two methods of the study \nthat is being done Aspect Senti ment Unification Model and \nthe s entence  latent dirichlet allocation  (LDA ) [10] of w hich \nthe greater range of the learning is done with the help of the \nproposed terminology. So far the classical  methods are \nbeing discussed and now the automatic detection of the \nsentiment is proposed in this method [18]  [24] by removing \nthe noisy information fr om the data. The  primary task is to \nautomatically classify the positive or the negative sentiment \nin the given sentences [14] so the features used here are the \nmeta -features [18] with the two types of the classifiers such \nas the Subjective classifiers and the Pola rity classifiers.', 'sentiment analysis and opinion mining ." In LREc , vol. 10, no. 2010, \npp. 1320 -1326. 2010.  \n[17] Kouloumpis, E., Wilson, T. and Moore, J., 2011, July. Twitter \nsentiment analysis: The good the bad and the omg!. In  Fifth \nInternational AAAI conference on weblogs and social media . \n[18] Barbosa, Luciano, and J unlan Feng. "Robust sentiment detection on \ntwitter from biased and noisy data." In  Proceedings of the 23rd \ninternational conference on computational linguistics: posters , pp. 36 -\n44. Association for Computational Linguistics, 2010.  \n[19] Greenspan, Hayit, Bram Van Ginneken, and Ronald M. Summers. \n"Guest editorial  deep learning in medical imaging: Overview and \nfuture promise of an exciting new technique."  IEEE Transactions on \nMedical Imaging  35, no. 5 (2016): 1153 -1159.  \n[20] Poria, Soujanya, Erik Cambria, Devamanyu Hazarika, Navonil \nMajumder, Amir Zadeh, and Louis -Philippe Morency. "Context -\ndependent s entiment analysis in user -generated videos."', 'anandkumar@cb.amrita.eduAbstract.The contemporary work is done as slice of the shared task inSentiment Analysis in Indian Languages (SAIL 2015), constrained vari-ety. Social media allows people to create and share or exchange opinionsbased on many perspectives such as product reviews, movie reviews andalso share their thoughts through personal blogs and many more plat-forms. The data available in the internet is huge and is also increasingexponentially. Due to social media, the momentousness of categorizingthese data has also increased and it is very diﬃcult to categorize suchhuge data manually. Hence, an improvised machine learning algorithm isnecessary for wrenching out the information. This paper deals with ﬁnd-ing the sentiment of the tweets for Indian languages. These sentimentsare classiﬁed using various features which are extracted using words andbinary features, etc. In this paper, a supervised algorithm is used for clas-sifying the tweets into positive, negative and neutral labels using NaiveBayes classiﬁer.Keywords:Sentiment analysis\n·Features ·Social media ·Machine learning\n·Supervised algorithm ·Naive Bayes classiﬁer\n1 Introduction', 'Sentiment Analysis is a rapidly growing ﬁeld of data analytics [ 1]. Sentiment is a thought, a judgment or an emotional response driven by a feeling. Sentiment Analy-sis, also known as opinion mining, deals with appraisal of peoples inclination towardsan entity. An entity can be anything with a commercial value. Sentiment analysishas its foundation on the world wide web. From a users perspective, various con-tents related to their personal and public life can be hosted through social mediaplatforms such as online social networking websites or e-commerce websites. Froma technical perspective, most social media websites are empowered with built-inApplication Programming Interfaces (APIs), prompting data collection and investi-gation by researchers and developers. Fundamentally, sentiment analysis affords aresourceful mechanism with the support of online data [ 2]. We propose Automated Review Analyzing System (ARAS), a new approach forassessment of customers market sentiments toward a product or service, though theirtransactions on of e-commerce websites. The prevailing system is the Star system,which analyzes a customers sentiment of a product expressed by a star value between1 and 5 (Fig.1). The basic ﬂaw of this strategy is the lack of choice. Users are onlygiven ﬁve options to rate the product. This can affect the realistic evaluation ofcustomers experience that the users provide. There are categories of users who feelthe', 'corpus learned seeds and polarity lexiconfor sentiment analysis. International Conference on Computing and Network Communications,CoCoNet (2015)12. Hu, M., Liu, B.: Mining and summarizing customer reviews In: Proceedings of the tenth ACMSIGKDD international conference on Knowledge discovery and data mining. pp. 168–177.ACM, New Y ork, NY , USA (2004)13. Gann, W.-J.K., Day, J., Zhou, S.: Twitter analytics for insider trading fraud detection systemIn:. Proceedings of the Sencond ASE International Conference on Big Data. ASE (2014)14. Rafeek, R., Remya, R.: Detecting contextual word polarity using aspect based sentiment analy-sis and logistic regression. IEEE International Conference on Smart Technologies and Manage-ment for Computing, Communication, Controls, Energy and Materials, ICSTM 2017—Pro-ceedings (2017)15. Pang, B., Lee, L.: Opinion mining and sentiment analysis. Found Trends Inf Retr 2(1–2):1135(2008)', 'ﬂaw of this strategy is the lack of choice. Users are onlygiven ﬁve options to rate the product. This can affect the realistic evaluation ofcustomers experience that the users provide. There are categories of users who feelthe ﬁve-star rating is insufﬁcient to express their views. People who wish to rate aproduct less than 1 star or those who wish to rate a product between 1 star and 2stars, etc., belong to this category. Some people feel that a particular product doesnot deserve even a single star or at other instances, a user feels that the product(or service) deserves more than 5 stars. For example, a user who had a horribleexperience with the product is constrained to rate it 1 star whereas a user who hadthe best experience is unable to rate it over 5 stars. On the other hand, Sentimentanalysis gives the user express more precise feelings about a product or service inthe market. This is because, unlike the star system, sentiment analysis feeds off thereviews written by users. A user is free to use the complete English vocabulary toexpress his/her feelings.', 'in the sentiment analysis which uses the data from the \nTwitter, with the term frequency inverse docum ent \nfrequency ( tfidf) and the global vectors (g lovec ) as the \nfeature extraction. Sentiment is considered as the emotion \nwhich means the emotion pertains to the particular feeling \nrather the sentiment pertains to the general perspective of \nthe task [15]  [25]. The author of this paper aims for the \ndetection of the intensity of the emotion from the text. Here \nthe four types of the emotions are considered they are anger, \nfear, joy and sadness [17]. The datasets are annotated by \nusing the method called as the Best Wo rst Scaling  (BWS)  \n[2]. The dataset that has been created is the first ever type of \nthe dataset that has been created for the emotion intensity \nthat has been annotated with the BWS method, the \nbenchmark system has been created with the regression \nsystem by conducting the various experiments on them [1] \n[2]. The Twitter  data and the Short Message Service ( SMS ) \nare being used  as a part of the semeval 2013 task were in \nthe SVM gives an accuracy of about 71.9% which they have \nclaimed as the best by using the su pervised statistical', '1≤k≤n d≤np(t k|c) (1)As shown in the Fig.2, the tweets are taken and if it includes any punctua-tions other than exclamations and question marks, it is removed and the tweetids are also processed. If the tweet has any binary feature, they are marked 1. AMRITA-CEN@SAIL2015: Sentiment Analysis in Indian Languages 707\nFig. 2.Tweets-before and after preprocessing\n3 An Analysis of SAIL Dataset', 'work should exploredifferent recurrent neural networks (RNN) including bi-directional recurrent NN andLong-ShortTerm Memory (LSTM) RNNs that try to capture aspect-speciﬁc senti-ment through context. In [9], authors have performed classiﬁcation of text usingvarious algorithms. Pang and Lee [10] suggested removal of objective sentencesby extracting the subjective ones among them. They proposed a text-categorizationtechnique that can be used in the identiﬁcation of subjective content. A novel semi-supervised approach was proposed by Sanagar Gupta to construct polarity lexiconusing iterative Latent Semantic Analysis technique [ 11] from unlabeled multiple source domains corpus. This technique was proven to have a considerable gain inthe accuracy compared to the models until then. Hu and Liu [ 12] summarized a list of positive and negative words based on customer reviews. While the positive listcontained 2006 words, the negative list had 47,883 words. The problem with thisclassiﬁcation scheme was that both the lists contained many misspelled words, acommon circumstance in the digital ﬁeld. In [ 13], the authors have performed classi- ﬁcation about 6799 tokens of Twitter data to identify sentiment score. Rafeek Remyain [14] discussed methods to detect polarity in sentiment analysis regression models.He considered product review dataset and', '3 Methodology\nNumerous websites/companies resort to Sentiment Analysis as a process to appraisethe current trends in customer satisfaction or product acceptance. On the other hand,users provided with the star rating system, discussed earlier, are restricted to providean unfeigned assessment of the quality of any product or service. Companies rely onsentiment analysis rather than the star system, as the former offers their Customersunhindered options to express their experience of a product or service. Automated Review Analyzing System … 333\n3.1 W eb Scraping', 'technology.In: 20th International Conference on Computational Linguistics (2004)7. John, G.H., Langley, P.: Estimating continuous distributions in Bayesian classiﬁers.In: Eleventh Conference on Uncertainty in Artiﬁcial Intelligence (1995)8. Godbole, N., et al.: Large-scale sentiment analysis for news and blogs. ICWSM 7, 21 (2007)9. Kouloumpis, E.: Twitter sentiment analysis: the good the bad and the omg!. Icwsm11, 538–541 (2011)10. Pang, B., Lee, L.: Opinion mining and sentiment analysis. Found. Trends Inf. Retr.2(1–2), 1–135 (2008)11. Mikolov, T., et al.: Eﬃcient estimation of word representations in vector space(2013). arXiv preprintarXiv:1301.378112. Turney, P.D., et al.: From frequency to meaning: vector space models of semantics.J. Artif. Intell. Res.37(1), 141–188 (2010)13. Rennie, J.D., et al.: Tackling the poor assumptions of naive bayes text classiﬁers.In: ICML, vol. 3 (2003)14. Jordan, A.: On', 'The user has r equest ed enhanc ement of the do wnlo aded file. Automated Review Analyzing SystemUsing Sentiment Analysis\nA. C. Jishag, Vishnu Rakhesh, Suraj Mohan, N. Vinayak V arma,V aisakh Shabu, Lekshmi S. Nair and Maya MenonAbstractAn integral part of human behavior has always been to ﬁnd out what othersthink about what would happen next. With the ongoing trend of e-commerce websitesand personal blogs, people make active use of various technologies to understand andclassify opinions. This paper introduces a new system to understand the emotions andfeelings underlying the reviews provided by users on various e-commerce websites.This system holds an edge over the current rating system of star values by providingthe users with a more precise and descriptive result. The main disadvantage of thestar system is that it does not provide enough choice to the user. The methodologymentioned in this paper, named ARAS or Automated Review Analyzing System,overcomes this issue by using sentiment analysis which feeds upon each word in thereview rather than a separate weighing system.KeywordsSentiment analysis\n·Review system ·Lexicon method ·Web crawling', 'area: Emotion detection in e -learning using opinion mining \ntechniques." In  2009 3rd IEEE International Conference on Digital \nEcosystems and Technologies , pp. 259 -264. IEEE, 2009.  \n[6] Desmet, Bart, and VéRonique Hoste. "Emotion detection in suicide \nnotes."  Expert Systems with Applications  40, no. 16 (2013): 6351 -\n6358.  \n[7] Bhaskar, Jasmine, K. Sruthi, and Prema Nedungadi. "Enhanced \nsentiment analysis of informal textual communication in social media by considering objective words and intensifiers." In  International \nConference on Recent Advances and Innovations in Engineering \n(ICRAIE -2014) , pp. 1 -6. IEEE, 2014.  \n[8] George, Anon, Barathi Ganesh HB, and K. P. Soman. "Teamcen at \nsemeval -2018 task 1: global vectors representation in emotion \ndetection." In  Proceedings of the 12th international workshop on \nsemantic evaluation , pp. 334 -338. 2018.  \n[9] Cambria, Erik, Björn Schuller, Yunqing Xia, and Catherine Havasi. \n"New avenues in opinion mining and sentiment analysis."  IEEE', '[9] Cambria, Erik, Björn Schuller, Yunqing Xia, and Catherine Havasi. \n"New avenues in opinion mining and sentiment analysis."  IEEE \nIntelligent systems  28, no. 2 (2013): 15 -21. \n[10] Jo, Yohan, and Alice H. Oh. "Aspect and sent iment unification model \nfor online review analysis." In  Proceedings of the fourth ACM \ninternational conference on Web search and data mining , pp. 815 -824. \nACM, 2011.  \n[11] Khan, Aurangzeb, Baharum Baharudin, Lam Hong Lee, and \nKhairullah Khan. "A review of machin e learning algorithms for text -\ndocuments classification."  Journal of advances in information \ntechnology  1, no. 1 (2010): 4 -20. \n[12] Pennington, Jeffrey, Richard Socher, and Christopher Manning. \n"Glove: Global vectors for word representation." In  Proceedings of \nthe 2014 conference on empirical methods in natural language \nprocessing (EMNLP) , pp. 1532 -1543. 2014.  \n[13] Nakov, Preslav, Alan Ritter, Sara Rosenthal, Fabrizio Sebastiani, and', 'tweets. The tweets are categorized as the positive and the \nnegative t weets based on the subject matter to which they \nbelong to, they are labelled as 0, stands for the negative \nIEEE - 45670\n10th ICCCNT 2019 \nJuly 6-8, 2019, IIT - Kanpur, \nKanpur, India \nAuthorized licensed use limited to: Amrita School Of Engineering - Kollam. Downloaded on August 27,2024 at 04:42:00 UTC from IEEE Xplore.  Restrictions apply.  reviews and the 1 , stands for the positive review. The main \nsource of the data is the internet which means that the data is \ncollected by the online pub lically available dataset for the \niphone reviews, movie reviews, weather reviews, general \nreviews that are clubbed together so that the dataset contains \nthe multiple view points from the various sources. By this \nmethod the new dataset is created consisting  of only positive \nand the negative reviews which is a total sentence of about \n4,00,000. Out of which , 2,00,000 is of the positive sentences \nand negative sentences each. The dataset is made to run in \nthe deep learning algorithm with the various split s and th e \nresults are tabulated in the Table I below:', 'prediction as it can capture the latent relation among the data. In [ 5], authors have suggested classiﬁcation using SVM.Hu and Liu [6] proposed several methods to analyze customer reviews from acorpus containing all types of reviews, such as negative, positive, and neutral. Theyidentiﬁed the customer opinions and emotions and classiﬁed them as positive or 332 A. C. Jishag et al.', 'which abundance amount of the text data are generated [5] \n[16]. \n \n Text is a way through which the emotions are being \nexpressed irrespective of the language because the language \ndiffers from place t o place were as the emotion contained in \nthe text remains the same [3] [9]. All the actions of the \nliving beings expresses their emotion towards them . The \npresent era in which we are living is 21st century were the information has a great value, that is we  live in information \nage Internet have become easily accessible to everyone [7] \n[10]. The digital identity of the person are created when \npeople began to use the social media resources like \nFacebook, Twitter , Instagram, G -mail, Snapcha t, Whatsup, \nYoutube a nd in the e -commerce  websites such as the \nAmazon, F lipkart, Snapdeal  etc. the most commonly used \nwebsites. The text data that is created in the social media are \nbound to the certain information it contains say some social \nissue, political issue, product re view, movie review \ncommented by people  publically [8], early days ones \nopinions cannot be shared in the large manner by the power \nof the social media and the generous opinions of the user so', 'topic or whatever the situation pertain to so that the mood of \nthe person can be judged. But the emotion is same for each \nand every person irrespective of the gender, but it changes \naccording to the mood and the mindset of the  person [5] \n[12]. But the difference in opinion is leading to a lot of the \nnegative impact so to prevent the suicidal incidents the \nmodel ha s been created for which the f1 -score of the model range is of 68.86% is achieved with the difference in the \nvariety  of the  emotions [6] [11]. The machine and the deep \nlearning approach are used to classify the type of the \nemotion in order to prevent the cases, through the text the \nstate of the pe rson is being well defined. Nowa days the \ntechnique called as the microblog ging is upcoming famous \nwhen compared to that of the classical  methods, one’s  \nopinion are being shared and read by the means of the \nblogging [16]. So the likes and the dislike s of the person are \nbeing studied and analyzed with the help of the \nmicroblogging  [16] [9]. The dataset which is used in the \ntask is of the Twitter  dataset and the corpus collection', '1. Kim, S.-M., Hovy, E.: Determining the sentiment of opinions In:. Proceedings of the 20thInternational Conference on Computational Linguistics, p. 1367. Association for Computa-tional Linguistics, Stroudsburg, PA, USA2. Xing, F., Zhan, J.: Sentiment analysis using product review data, Department of ComputerScience, North Carolina A T State University, Greensboro, USA (2015)3. Chesley, P ., Vincent, B., Xu, L., Srihari, R.K.: Using verbs and adjectives to automaticallyclassify blog sentiment. Training 580(263), 233 (2006) 4. Liu, B.: Sentiment analysis and opinion mining. Synthesis Lectures on Human LanguageTechnologies. Morgan Claypool Publishers 338 A. C. Jishag et al.5. Thara, S., Sidharth, S.: Aspect based sentiment classication: SVD features. International Con-ference on Advances in Computing, Communications and Informatics, ICACCI (2017)6. Hu, M., Liu, B.: Mining and summarizing customer reviews. KDD 04, 2004 (2004) 7. Paulus, R., Socher, R., Manning, C.D.: Global belief recursive neural networks. In: Advancesin Neural Information Processing Systems 2014, pp. 2888–28968.', 'Hindi 55.67 % 45.79 % 57.37 % 80.0 %\nBengali 33.6 % 29.58 % 34.44 % 39.26 %\nFig. 3.Bar chart representation of the ﬁnal result\n5 Conclusion and Future Work\nWe have presented a method to classify twitter data based on the sentimentwhich is highly useful in the ﬁeld of information retrieval (IR). In this work,we classify the tweets of the Indian languages into positive, negative and neu-tral classes. Generally before classifying the tweets, preprocessing is done. Thisis carried out in order to eliminate the unwanted symbols and also to retrievewords which are highly useful for analysing sentiment. The preprocessing stepis taken extra care of and it gave better result after classiﬁcation. Naive Bayesalgorithm is used which gives a better classiﬁcation result. This method can alsobe extended using SVM classiﬁer and also the unsuupervised way of implemen-tation can be done as future work.\nReferences', 'Abstract — Powerful weapon in today’s world  is ones emotion \nis social media. They have the power to make an individual \ntrendin g overnight or even may pull down  anyone reputation. \nIn this paper , the sentiment analysis task has been performed \nby collecting the dataset from the publically available sources \nand by merging  them together  to for m a new dataset for the \nsentiment analysis  task that is positive or negative sentiment \nbased  on the context of the subject. A new reliable  dataset is \nsubjected to various pre -processing techniques and then the \nfeature extraction techniques aftermath  they are passed to the \ndeep learning technique s out of which by using the text \nrepresentation method , global vectors ( glovec ) with the  long \nshort -term memory ( lstm) has the highest accu racy of 75%, \nwhich is the bench mark accuracy for this dataset. For the \nresearch purpose the dataset used in this paper is made \navailable publically for research purpose.  \n \nKeywords — Twitter , Sentiment, Sentiment analysis, Text \nrepresentation, Machine learning, Deep learning.  \nI. INTRODUCTION  \nThe usage of t he mobile phones are common nowa days, \nwhich has led to a very large scal e users of the social media', 'We propose an Automated Review Analyzing System (ARAS), a new approachfor assessment of customers market sentiments toward a product or service, thoughtheir transactions on of e-commerce websites. The prevailing system is the Starsystem, which analyzes a customers sentiment of a product expressed by a star valuebetween 1 and 5 (Fig.1). The basic ﬂaw of this strategy is the lack of choice. Usersare only given ﬁve options to rate the product. This can affect the realistic evaluationof customers experience that the users provide. There are categories of users whofeel the ﬁve-star rating is insufﬁcient to express their views. People who wish torate a product less than 1 star or those who wish to rate a product between 1 starand 2 stars, etc., belong to this category. Some people feel that a particular productdoes not deserve even a single star or at other instances, a user feels that the product(or service) deserves more than 5 stars. For example, a user who had a horribleexperience with the product is constrained to rate it 1 star whereas a user who hadthe best experience is unable to rate it over 5 stars. On the other hand, Sentimentanalysis allows the user express more precise feelings about a product or service inthe market. This is because, unlike the star system, sentiment analysis feeds off thereviews written by users. A user is free to use the complete English vocabulary', 'AMRITA-CEN@SAIL2015: Sentiment Analysisin Indian Languages\nShriya Se(B), R. Vinayakumar, M. Anand Kumar, and K.P. Soman\nCentre for Excellence in Computational Engineering and Networking,Amrita Vishwa Vidyapeetham, Ettimadai, Coimbatore, India{shriyaseshadrik.r,vinayakumarr77 }@gmail.com,m', 'Sentiment Analysis can be performed in two ways: Lexicon method and machinelearning. In the Lexicon approach, sentiment value is obtained by comparing thedataset being reviewed with two pre-deﬁned value sets, whereas in machine learningapproach, the dataset is divided into test set and training set. Training set is usedfor the learning process, followed by processing the test set for prediction of thesentiment value. The proposed model uses the lexicon method rather than Machinelearning to ﬁnd the sentiment value of the reviews. This is because even thoughreviews are plentiful in any e-commerce website, a corpus generated from thesereviews is not generally long enough to perform adequate supervised learning onInitially, the whole review set is made into a corpus. This corpus would contain stopwords, punctuation, and numbers, etc., which provide no impact on the sentimentvalue. Hence, these unwanted peripheral items are removed in the preprocessing step.Punctuation numbers are removed ﬁrst followed by the removal of white spaces. Allthe words in the corpus now are transformed into lower case. Next, a predeﬁneddictionary of stop words is now loaded and is compared with the corpus to eliminatestop words. The process of Stemming is now applied to the corpus and the ﬁnal,preprocessed corpus is made into a term–document matrix. A document-term matrixrepresents', 'Marketing intelligence is the external data collected by a company about a speciﬁcmarket which it wishes to enter, to make decisions. It is the ﬁrst set of data whichthe company analyses before making any investment decision. An important hurdlefor Market Intelligence is the process of gathering consumer opinions of competingproducts and establishing thresholds as to benchmarks for products and services.Currently, no automated system is able to perform visual comparison of consumeropinions as proposed in this paper.One of the main problems in sentiment analysis is the categorization of polarity[3]. Given a text span, it requires some intelligence or learning to categorize thetext into a speciﬁc polarity. In [4], authors have deﬁned three category document-level, sentence level, and entity aspect level The document-level is concerned aboutthe overall sentiment of the document, While sentence-level and entity aspect-levelanalysis human opinion.Singular value decomposition (SVD) is a means of decomposing a matrix into aproduct of three simpler matrices. Algorithms on machine learning and sentimentanalysis normally use Singular V alue Decomposition (SVD) based feature for sen-timent prediction as it can capture the latent relation among the data. In [ 5], authors have suggested classiﬁcation using SVM.Hu and Liu [6] proposed several methods to analyze customer reviews from acorpus containing', '04, 2004 (2004) 7. Paulus, R., Socher, R., Manning, C.D.: Global belief recursive neural networks. In: Advancesin Neural Information Processing Systems 2014, pp. 2888–28968. Lakkaraju, H., Socher, R., Manning, C.: Aspect speciﬁc sentiment analysis using hierarchicaldeep learning. In: Advancesmensts and Applications of Deep Learning in computer Systems(2014)9. Vijayan, V .K., Bindu, K.R., Parameswaran, L.A.: Comprehensive study of text classiﬁcationalgorithms. International Conference on Advances in Computing, Communications and Infor-matics, ICACCI (2017)10. Pang, B., Lee, L.L.: A sentimental education: Sentiment analysis using subjectivity sum-marization based on minimum cuts In: Proceedings of the 42nd Annual Meeting on Asso-ciation for Computational Linguistics, ACL 04. Association for Computational Linguistics,Stroudsburg, PA, USA (2004)11. Sanagar, S., Gupta, D.: Adaptation of multi-domain corpus learned seeds and polarity lexiconfor sentiment analysis. International Conference on Computing and Network Communications,CoCoNet (2015)12. Hu, M., Liu, B.: Mining and summarizing customer reviews In: Proceedings of the tenth', 'the corpus to eliminatestop words. The process of Stemming is now applied to the corpus and the ﬁnal,preprocessed corpus is made into a term–document matrix. A document-term matrixrepresents frequency of words with respect to collection of documents in matrix form.Each term in the matrix is now compared with two dictionaries, positive lexicon setand negative lexicon set. Positive Lexicon set would contain words that provide apositive sentiment to the sentence negative lexicon set would contain words thatprovide a positive sentiment to the sentence. Each word is tagged with a weight withrespect to the intensity of the sentiment it provides to the context. 334 A. C. Jishag et al.', 'shown in the Table IV.  \nTABLE IV.  RESULTS FOR DEEP LEA RNING APPROACH  USING GLOVEC  \nMethod  Classifie rs Accuracy  \nGlovec  LSTM  75.3 \nGRU  63.2 \nSimple RNN  69.5 \nVIII. CONCLU SION \nThis paper evaluates the performance of linear and non -\nlinear text representation methods for sentimental analysis.  \nThe collected dataset  “Amrita -CEN -SentiDB1 ” is subjected \nto various non -linear text representation methods with the \ndeep learning architecture which performs better than the \nlinear text representation with the machine learning \nalgorithms. The performance of the proposed method can be \nincreased experimentally by hyper parameter  tuning the \nnetwork . This is the benchmark accuracy for this dataset \nfurther the dataset is made publically available for the \nresearch purpose.  https://vinayakumarr.github.io/Amrita -\nCEN -SentiDB1/  \nREFERENCES  \n[1] Mohammad, Saif M., and Felipe Bravo -Marquez. "Emotion \nintensities in tweets."  arXiv preprint arXiv:1708.03696  (2017).', 'in the given sentences [14] so the features used here are the \nmeta -features [18] with the two types of the classifiers such \nas the Subjective classifiers and the Pola rity classifiers. \nThese are some of the study done on the existing methods \nfor the sentiment analysis from the classical  method to the \nrecent methods.  \n \nThe motivation of the paper is to create a database from the \nvarious publically available datase ts for various reviews and \nto apply the classical machine learning methods over the \ntraditional methods in order to study the dataset collected. \nThe paper stands alone from the existing methods by the \nfollowing ways : the da ta used here is unique with the w ord \nembedding techniques for the machine learning and the deep \nlearning algorithm creating a benchmark accuracy of about \n75% for this dataset.  \nIII. BACKGROUND  \nA. Term Frequency I nverse Document Frequency ( tfidf) \nTerm Frequency Inverse Document Frequency  (tfidf) is  \ncommonly used for the purpose of the vectorising, aftermath \nthe features are extracted from them. The vectorising is done \nby the means of the assigning the weight to the extracted \nfeature for the process of extraction of the information. The', 'and negative sentences each. The dataset is made to run in \nthe deep learning algorithm with the various split s and th e \nresults are tabulated in the Table I below:  \nTABLE I.  DATASET DESCRIPTION  \nDataset  Split  Positive  Negative  Total  \nTraining  60:40  1,20,000  1,20,000  4,00,000  \nTesting  80,000  80,000  \nTraining  70:30  1,40,000  1,40,000  4,00,000  \nTesting  60,000  60,000  \nTraining  80:20  1,60,000  1,60,000  4,00,000  \nTesting  40,000  40,000  \nTraining  90:10  1,80,000  1,80,000  4,00,000  \nTesting  20,000  20,000  \nV. METHODOLOGY  \nThe sentiment are of the two major types such as the \npositive and the negative. The positive and the negative  \nsentiments  are based on the tone and the expression of the \nfeeling towards the particular context of the subject. Here \ncomes an example “I am happy” in this context the word', 'Fig. 2Graph containing sentiment value for the ﬁrst 100 reviews Automated Review Analyzing System … 335\nFig. 3Sentiment value generated for each hotel\nFig. 4Sentiment Analysis result generated for each hotel 336 A. C. Jishag et al.', '5 Conclusion and Further Improvements\nWe have done experimentation in a larger database considering reviews from 10different websites and attained an accuracy of 94%. The future scope for this modelon the followings.\n5.1 Semantics\nOur algorithm computes the overall sentiment of user reviews. Polarity plays a bigrole in sentiment analysis. For example, imagine the case of a review where the userpraises the hygiene of the hotel but is disappointed with its locality. This is a positivereview for a user, who gives priority to the hygiene but on the other hand a user whocares more about the locality would rate this as a negative review. This difﬁculty ofclassiﬁcation was overcome in the suggested model as the classiﬁcation dependedon the query term this emphases on the semantics. Automated Review Analyzing System … 337\n5.2 Part of Speech (POS) T agger\nThe POS tagger takes a notably long time for training the system. This, in turn, led toa big spike on the execution time of the model. It did improve the computed accuracy,but we did not have enough time to conduct these tests.\n5.3 Support V ector Machines\nPang and Lee [15] showed that SVM performed the best when classifying moviereviews as positive or negative. An important next step would be to further exploreSVM parameters for classifying reviews.', 'classified into two ma jor types  such as the supervised and \nunsupervised. They outperforms well for the classification \ntasks when it comes to the smaller data but once the large \ndataset is passed there comes a problem. That is rectified by \nthe means of the deep learning algo rithms  [23]. The feature \nextraction methods and the vectorization determines the \nperformance of the algorithm. The main objectives of this \nwork are as follows:  \n1. To develop a Twitter  database for the sentimental \nanalysis.  \n2. To perform various text representati on methods \nand to evaluate those methods on the sentimental \ndatabase.  \n3. To do a comparative study on the sentimental \ndatabase by using the deep learning techniques.  \nIEEE - 45670\n10th ICCCNT 2019 \nJuly 6-8, 2019, IIT - Kanpur, \nKanpur, India \nAuthorized licensed use limited to: Amrita School Of Engineering - Kollam. Downloaded on August 27,2024 at 04:42:00 UTC from IEEE Xplore.  Restrictions apply.  4. To develop an improved  database for the \nsentimental analysis task by collecting only the \npositive and negative reviews for the sentimental \nanalysis task.', 'are being used  as a part of the semeval 2013 task were in \nthe SVM gives an accuracy of about 71.9% which they have \nclaimed as the best by using the su pervised statistical \nmethod for the text classification [3]  [23]. Emotions can be \nexpressed by the opinions or the facts the opinions are much \nmore valuable than that of the facts because the opinions \nhave the i ntensity of the emotions so nowa days the artificia l \nintelligence is playing a vital role which is changing all the \nindustry to move on to it were in the computers can \nunderstand the [8] [13] language with the help of the text \nrepresentation techniques that are being used for the feature \nextraction task so  the worst scaling method is used in the \nprocess of the annotation of the data [4] [7]. The model will \nbe judged based on the data if the dataset collected is good \nand obviously the trained model will be good. The text is so \npowerful  that the person intere st can easily be known to the \ntopic or whatever the situation pertain to so that the mood of \nthe person can be judged. But the emotion is same for each \nand every person irrespective of the gender, but it changes', 'Fig. 2.Tweets-before and after preprocessing\n3 An Analysis of SAIL Dataset\nSAIL stands for Sentiment Analysis for Indian Languages. They have releasedtwitter dataset for three languages namely Tamil, Hindi, Bengali. The size of thetraining and testing dataset is shown in Table3in which approximately 27 % oftraining data of Tamil and Hindi and 54 % of the Bengali data contain URLs.Most of the Tamil tweets are regarding movie reviews and comments about someactors and actresses whereas the Hindi tweets are based on politics. The datasethas issues such as single tweet are there in both of the positive and negativetraining data and also there are tweets which are repeated. Many of these tweetsare misspelt which aﬀect the accuracy of the classiﬁer. The training dataset ofTamil tweets contains more colloquial words which is not present in Sentiwordnetand hence it is not clean whereas the Hindi and Bengali tweets are conventional.In the test data, many of the ambiguous tweets are present. As these data arealready ambigiuous, the accuracy drops.\nTable 3.Twitter training dataset for SAIL 2015 shared task\nLanguage Training data Test data\nPositive Negative Neutral Total\nTamil 387 316 400 1103 560\nHindi 168 545 493 1222 467\nBengali 277 354 368 999500 708 S. Se et al.', 'from the training dataset which is already labelled. A smallpart of the data from the training dataset say about 10 % is taken and given forthe validation process. This is given as an input for the Naive Bayes classiﬁer and AMRITA-CEN@SAIL2015: Sentiment Analysis in Indian Languages 705', 'I. INTRODUCTION  \nThe usage of t he mobile phones are common nowa days, \nwhich has led to a very large scal e users of the social media \nwhich on other hand has become tremendously powerful \n[1]. The information shared in the social media is so fast and \nquick that anything happens in any part of the world is \ncoming to light within minutes  [2]. In the classical  days, \npeople were busy in their work relying on the radio, \ntelevision, n ewspapers , etc. for the information [3] [ 6], it \ntakes time to reach the people. But things started changing \ndevices are becoming smarter than the humans, just one \nclick the information is in ou r hands. The information which \nare shared are in the form of the text so the text analytics, \nlinguistics are the blooming era now. But the machine s are \nsmarter than people [ 4] [ 8] they have the ability to \nunderstand the text through the algorithms that are  \nexclusively done for  them. Social media is the platform in \nwhich abundance amount of the text data are generated [5] \n[16]. \n \n Text is a way through which the emotions are being \nexpressed irrespective of the language because the language', 'the data  are converted into the words as the part of the pre -\nprocessing technique. For example , the “23” will be \nconverted into the “twenty three”. In some cases , the letter \n“2” will be used in the words instead of the word “to” here \nin this sentence “I went 2 the market” here the “2” refers to \n“to”. So these are some of the challenging task when it \ncomes to the conversion of the numbers. Suppose if the \nnumber “2” is removed directly then the sentence becomes \nincomplete.  \n3) Removal of the punctuations and special ch aracters : \nThe data used in this work is the Twitter  data which mainly \nfocuses on the tweets, so while tweeting the original \nemotion of the person is expressed in the words. The tweets \nconsists of the lots of the special characters, punctuations, \naccent mar ks and emojis. The main challenging role in the \ntext data pre -processing comes here is that many languages \nare spoken world -wide so the pronunciation of the word \ndiffers in each place  so in order to spell the word correctly', 'commented by people  publically [8], early days ones \nopinions cannot be shared in the large manner by the power \nof the social media and the generous opinions of the user so \nmany things are changed and will be changing  [18].  \n \nThe text that  are pre sent in the social media are of three \nmain types such as the Mixed Script (which is a \ncombination of both the native script and the roman script), \nCode -Mixed Script (this  is a special type which is the \ncombination of the native and the English language that is \nwritten in the roman script), Native Script (it refer to the \nnative or regional lang uage of that particular region). So \nwhen compared to all the text that are available , the most \nused type of the script is the code mixed script [2] [15].  \n \nIn the current method the machine learning is paving the \npath in the various fields , one such is the natural language \nprocessing, here the data used for the processing is the text \ndata [22]. Primarily, m achine learning algorithms are \nclassified into two ma jor types  such as the supervised and \nunsupervised. They outperforms well for the classification \ntasks when it comes to the smaller data but once the large', 'See discussions, st ats, and author pr ofiles f or this public ation at : https://www .researchgate.ne t/public ation/332102965\nAutomated Review Analyzing System Using Sentiment Analysis\nChapt er · Januar y 2019\nDOI: 10.1007/978-981-13-5934-7_30\nCITATIONS\n5READS\n321\n7 author s, including:\nLekshmi S Nair\nAmrit a Vishw a Vidyapee tham K ollam\n27 PUBLICA TIONS \xa0\xa0\xa0134 CITATIONS \xa0\xa0\xa0\nSEE PROFILE\nMay a Menon\nAmrit a Vishw a Vidyapee tham\n4 PUBLICA TIONS \xa0\xa0\xa028 CITATIONS \xa0\xa0\xa0\nSEE PROFILE\nAll c ontent f ollo wing this p age was uplo aded b y Lekshmi S Nair  on 21 A ugust 2020.\nThe user has r equest ed enhanc ement of the do wnlo aded file. Automated Review Analyzing SystemUsing Sentiment Analysis', 'negative, ignoring the neutral ones. However, this technique is primarily based onunsupervised itemset mining, which is amenable for analysis when the user writes acomplete, fully formatted review. This technique cannot be implemented for reviewswhich are very brief. Recent works [PSM14] [ 7] introduced a new model that allows neural nets (NN) to evaluate contextual sentiment: The proposed Global Belief-Recursive Neural Network (RecNN) represents the granular sentiment analysis. Abackward step from upper tree nodes is introduced their methodology in order tofaithfully capture contextual sentiment. A different approach is obtained by consid-ering aspect-speciﬁc sentiment analysis, using hierarchical deep learning accordingto [LSM] [8]. Here, separate aspect sentiment (SAS) models or Joint Multi-AspectSentiment (JMAS) models train root node-level softmax classiﬁers, a commonlyused classiﬁer after SVM with a different loss function, with aspect and sentimentas classiﬁcation outputs. However, a relabeling of product features is necessary forthese models, mentioned above by Hu, M. and Liu, B. Their work should exploredifferent recurrent neural networks (RNN) including bi-directional recurrent NN andLong-ShortTerm Memory (LSTM) RNNs that try to capture aspect-speciﬁc senti-ment through']

# Get optimal number of clusters using BIC
def get_optimal_clusters(embeddings, reduced_dim, max_clusters=20):
    bic_scores = []
    for n_clusters in range(1, max_clusters):
        log_likelihood, _, _, _ = gmm(embeddings, n_clusters)
        mean_params = n_clusters * reduced_dim
        cov_params = n_clusters * (reduced_dim * (reduced_dim + 1) // 2)
        pi_params = n_clusters - 1
        k = mean_params + cov_params + pi_params # Total numbero f params
        bic = -2 * log_likelihood + k * np.log(len(embeddings))
        bic_scores.append(bic)

    return np.argmin(bic_scores) + 1
a = umap(x, GPT4AllEmbeddings(), 17, 10)
optimal_clusters = get_optimal_clusters(a, 10)